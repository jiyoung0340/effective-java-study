# Itme12. toString을 항상 재정의하라.

## Object의 기본 toString은 적합한 문자열을 반환하는 경우가 거의 없다.
이 메서드는 PhoneNumber@aabbcc 와 같이 단순히 **클래스_이름@16진수로_표시한_해시코드**를 반환할 뿐이다.  
toString은 '간결하면서 사람이 읽기 쉬운 형태의 유익한 정보'를 반환해야 한다.  
또한 모든 하위 클래스에서 이 메서드를 재정의해야한다.

## toString을 잘 구현한 클래스는 사용하기 훨씬 편하고, 시스템을 디버깅하기 쉽다.
toString 메서드는 직접 호출하지 않더라도, println, printf, 문자열 연결 연산자(+), assert 등 자동으로 불린다.  
특히 컴포넌트가 오류 메시지를 로깅할 때 자동으로 호출해 이를 제대로 재정의하지 않으면 쓸모없는(봐도 정보를 얻기 힘든) 메시지만 로그에 남을 것이다.  
따라서 실전에서 toString은 그 객체가 가진 주요 정보 **모두**를 반환하는게 좋다.
다음은 중요 정보가 담기지 않았을 때의 문제가 되는 예이다.
```text
Assertion failure: expected {abc, 123}, but was {abc, 123}.
// 단언 실패 : 예상값 {abc, 123}, 실젯값 {abc, 123} 
```
이는 중요 정보가 빠져 실패의 원인을 찾기가 어렵다.

## toString 반환값의 포맷을 문서화할 것인가
전화번호나 행렬 같은 값클래스는 문서화하기를 권한다. 그 객체는 표준적이고, 명확하고, 사람이 읽을 수 있다.
따라서 그 값 그대로 입출력에 사용하거나 CSV파일처럼 사람이 읽을 수 있는 데이터 객체로 저장할 수도 있다.  
포맷을 명시화한다면, 포맷에 맞는 문자열과 객체를 상호 전환할 수 있는 정적 팰토리나 생성자를 함께 제공한다.  
**하지만 포맷을 한번 명시하면 평생 그 포맷에 얽매이게 된다.**  
따라서 향후 릴리즈에 포맷이 변경된다면 관련된 코드와 데이터들은 엉망이 될 것이다. 따라서 포맷을 명시하지 않았다면 이러한 변화에 유연하게 개선할 수 있을 것이다.

## 포맷을 명시하는 것과 별개로 의도는 명확히 밝혀야 한다.
```java
/*
 * 이 전화번호의 문자열 표현을 반환한다.
 * 이 문자열은 "XXX-YYYY-ZZZZ" 형태의 12글자로 구성된다.
 * XXX는 지역코드, YYY는 프리픽스, ZZZ는 가입자 번호이다.
 * 각 대문자는 10진수 숫자 하나를 나타낸다.
 * 
 * 전화번호의 각 부분에 값이 너무 작아 자릿수를 채울 수 없다면,
 * 앞에서부터 0으로 채워나간다. 
 * 예를 들어, 가입자번호가 123일 경우 전화번호의 마지막 네 문자는 "0123"이 된다.
 * */
    @Override
    public String toString() {
        return String.format("%03d-%03d-%04d", areaCode, prefix, lineNum);
    }
```
만약 포맷을 명시하지 않는다면,
```java
/*
 * 이 약물에 관한 대략적인 설명을 반환한다.
 * 다음은 이 설명의 일반적인 형태이나, 상세 형식은 정해지지 않았으며 향후 변경될 수 있다.
 * 
 * "[약물 #9: 유형=사랑, 냄새=테레빈유, 겉모습=먹물]"
 * */
    @Override
    public string toString() {
            ...
    }
```
로 표현할 수 있다. 

## 포맷 명시하는 것과 별개로 toString이 반환한 값에 포함된 정보를 얻어올 수 있는 API를 제공하자.
예컨대, PhoneNumber클래스는 지역코드, 프리픽스, 가입자번호 각각의 접근자를 제공해야한다. 
그렇지 않으면 이 정보가 필요할 때 마다 toString의 반환값을 파싱해야한다.  
이는 성능이 나빠지고 불필요한 작업이다. 더불어 추후 toString의 포맷이 바뀌면 시스템전체에 악영향을 끼친다.

## 그리고
- 정적 유틸리티 클래스(Item4)은 toString을 제공할 이유가 없다.
- 열거 타입(Item34)도 자바가 완벽한 toString을 제공하므로 따로 재정의할 필요가 없다.
- 하위 클래스들이 공유해야 할 문자열 표현이 있는 추상클래스는 toString을 재정의해야 한다.
  대다수의 컬렉션 구현체는 추상 컬렉션 클래스의 toString메서드를 상속해 사용한다.
- AutoValue : toString도 생성하지만 각 필드의 의미를 파악하지는 못한다.   
  ex. PhoneNumber의 경우 전화번호 표준 체계를 따르는 것이 좋지만 AutoValue는 이를 파악하지 못한다.
